<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title>MotherEye</title>
    <link href="css/style.css" rel="stylesheet">
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/bootstrapresponsive.css" rel="stylesheet">
    <!--<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js"></script> -->
    <script type="text/javascript" charset="utf-8" src="js/jquery-1.10.2.min.js"></script>
    <script src="js/tracking.js-master/build/tracking-min.js"></script>
    <script src="js/tracking.js-master/examples/assets/stats.min.js"></script>
    <script src="js/tracking.js-master/examples/assets/color_camera_gui.js"></script>


    <script type="text/javascript">

        function open_modal( id ){
            var maskHeight = $(document).height();
            var maskWidth = $(window).width();

            $('#mask').css({'width':maskWidth,'height':maskHeight});

            $('#mask').fadeIn(1000);
            $('#mask').fadeTo("slow",0.8);

//Get the window height and width
            var winH = $(window).height();
            var winW = $(window).width();

            $(id).css('top',  winH/2-$(id).height()/2);
            $(id).css('left', winW/2-$(id).width()/2);
            $(id).fadeIn(2000);
        };
        $(document).ready(function() {

            $('a[name=modal]').click(function(e) {
                e.preventDefault();
                open_modal( $(this).attr('href') );
            });

            open_modal( '#dialog' );//abrindo o div#modal ao carregar a página

            $('.window .close').click(function (e) {
                e.preventDefault();

                $('#mask').hide();
                $('.window').hide();
            });

            $('#mask').click(function () {
                $(this).hide();
                $('.window').hide();
            });
        });
    </script>
</head>

<body>

<div class="mod">
    <div class="container">
        <div class="span9 offset1">
            <br/><br/>
            <div class="col-xs-12 col-md-8 col-sm-4">
                <h1 class="h">Teste Mother's Eyes</h1>
                <hr/>
            </div><br/>
            <div class="video">
                <video id="video" width="300" height="225" preload autoplay loop muted controls></video>
            </div>
        </div>
    </div>
</div>


<div id="boxes">
    <div id="dialog" class="window">
        <a href="#" class="close">Fechar [X]</a><br />
        <br />
        <div class="sets">
            <form class="form-horizontal" role="form" method="post">
                Twitter<br><input type="text" placeholder="twitter" name="way" id="t1"><br>
                SMS<br><input type="text" placeholder="Phone(SMS)" name="way" id="t2"><br>

                <select class="drop" name="cores" id="cores">
                    <option>Selecione uma cor</option>
                    <option value="azul">azul</option>
                    <option value="verde">verde</option>
                    <option value="vermelho">vermelho</option>
                    <option value="amarelo">amarelo</option>
                    <option value="pink">rosa</option>
                </select>
                <input type="button" value="Confirmar" onclick="pegaValor()" id="btn">
            </form>
        </div>
    </div>
</div>



<!-- Fim Janela Modal com caixa de diálogo -->
<script type="text/javascript">
    var cara = 'purple';
    var t;
    var s;
    var cor;
    function pegaValor() {
        var elemento = document.getElementsByName('way');
        t = elemento[0];
        s = elemento[1];
        var f = document.getElementById("cores");
        cor = f.options[f.selectedIndex].text;
        $('#mask').hide();
        $('.window').hide();
        //$('#dialogo').close();
        if(cor == 'verde') {
            var tracker = new tracking.ColorTracker(['green']);
        }
        if(cor == 'azul'){
            var tracker = new tracking.ColorTracker(['blue']);
        }
        if(cor == 'vermelho'){
            var tracker = new tracking.ColorTracker(['red']);
        }
        if(cor == 'amarelo'){
            var tracker = new tracking.ColorTracker(['yellow']);
        }
        if(cor == 'rosa'){
            var tracker = new tracking.ColorTracker(['magenta']);
        }


        var video = document.getElementById('video');
        //Identificador de cores

        tracking.track('#video', tracker, {
            camera: true
        });

        tracker.on('track', function (event) {
            if (event.data.length === 0) {

            } else {
                event.data.forEach(function (rect) {
                    alert("apareceu uma cor " + cor);
                });
            }
        });
    }

    //registro de cores

    tracking.ColorTracker.registerColor('purple', function(r, g, b) {
        var dx = r - 120;
        var dy = g - 60;
        var dz = b - 210;

        if ((b - g) >= 100 && (r - g) >= 60) {
            return true;
        }
        return dx * dx + dy * dy + dz * dz < 3500;
    });

    tracking.ColorTracker.registerColor('cyan', function(r, g, b) {
        var thresholdGreen = 50,
                thresholdBlue = 70,
                dx = r - 0,
                dy = g - 255,
                dz = b - 255;
        if ((g - r) >= thresholdGreen && (b - r) >= thresholdBlue) {
            return true;
        }
        return dx * dx + dy * dy + dz * dz < 6400;
    });

    tracking.ColorTracker.registerColor('magenta', function(r, g, b) {
        var threshold = 50,
                dx = r - 255,
                dy = g - 0,
                dz = b - 255;
        if ((r - g) >= threshold && (b - g) >= threshold) {
            return true;
        }

        return dx * dx + dy * dy + dz * dz < 19600;
    });

    tracking.ColorTracker.registerColor('yellow', function(r, g, b) {
        var threshold = 50,
                dx = r - 255,
                dy = g - 255,
                dz = b - 0;
        if ((r - b) >= threshold && (g - b) >= threshold) {
            return true;
        }
        return dx * dx + dy * dy + dz * dz < 10000;
    });

    tracking.ColorTracker.registerColor('red', function(r, g, b) {
        var threshold = 50,
                dx = r - 255,
                dy = g - 0,
                dz = b - 0;
        if ((r - g) >= threshold && (r - b) >= threshold && (g - b) <= threshold) {
            return true;
        }
        return dx * dx + dy * dy + dz * dz < 10000;
    });

    tracking.ColorTracker.registerColor('blue', function(r, g, b) {
        var threshold = 50,
                dx = r - 0,
                dy = g - 0,
                dz = b - 255;
        if ((b - r) >= threshold && (b - g) >= threshold && (r - g) <= threshold) {
            return true;
        }
        return dx * dx + dy * dy + dz * dz < 10000;
    });

    tracking.ColorTracker.registerColor('green', function(r, g, b) {
        var threshold = 120,
                dx = r - 0,
                dy = g - 255,
                dz = b - 0;
        if ((g - r) <= threshold && (g-r) >=10 && (g - b) <= threshold && (g-b) >= 10 && (r - b) <= 40){
            return true;
        }
        return dx * dx + dy * dy + dz * dz < 10000;
    });

    //registro de cores fim

</script>

<!-- Máscara para cobrir a tela -->
<div id="mask"></div>

</div>

<br /><br />

</body>
</html>
